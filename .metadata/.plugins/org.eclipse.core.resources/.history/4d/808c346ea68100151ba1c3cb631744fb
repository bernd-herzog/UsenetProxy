#include <netinet/in.h>

#include "server.h"
#include "client.h"


#define LISTEN_PORT 2537

struct {
	int socket;
} server;

void setupListenSocket()
{
	struct sockaddr_in local_addr4;
	memset( &local_addr4, 0, sizeof(local_addr4));
	//local_addr4.sin_len 	= sizeof(local_addr4);
	local_addr4.sin_family 	= AF_INET;
	local_addr4.sin_port 	= htons(localPort);
	local_addr4.sin_addr.s_addr = inet_addr("10.0.0.1");
}

void serverSetup()
{
	setupListenSocket();
	listen(server);
}

void parentCleanup()
{

}

void serverLoop()
{
	int running = 1;
	while (running == 1)
	{
		int sock = accept();
		doubleFork(clientMain, parentCleanup);
	}
}
